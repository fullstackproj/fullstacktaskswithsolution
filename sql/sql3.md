### :camel: SQL examples
---

#### Task1: write a SQL query to find all orders generated by London-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id

	*table: salesman with columns salesman_id,name,city,commission
	*table: Orders with columns Ord_no,purch_amt,ord_date,customer_id,salesman_id

```
SELECT *
FROM orders
WHERE salesman_id IN
    (SELECT salesman_id 
     FROM salesman 
     WHERE city='London');

```

#### Task2:  write a SQL query to count the number of customers with grades above the average in New York City. Return grade and count.

	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id

```
SELECT grade, COUNT (*)
FROM customer
GROUP BY grade
HAVING grade >
    (SELECT AVG(grade)
     FROM customer
     WHERE city = 'New York');

```

#### Task3:write a SQL query to find salespeople who had more than one customer. Return salesman_id and name.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id	

```
SELECT salesman_id,name 
FROM salesman a 
WHERE 1 < 
    (SELECT COUNT(*) 
     FROM customer 
     WHERE salesman_id=a.salesman_id);
```

#### Task4: write a SQL query to find salespeople who deal with multiple customers. Return salesman_id, name, city and commission.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id	

```
SELECT * 
FROM salesman 
WHERE salesman_id IN (
   SELECT DISTINCT salesman_id 
   FROM customer a 
   WHERE EXISTS (
      SELECT * 
      FROM customer b 
      WHERE b.salesman_id=a.salesman_id 
      AND b.cust_name<>a.cust_name));

```

#### Task5: write a SQL query to find all salespeople and customers located in the city of London.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id	
	
```
SELECT salesman_id "ID", name, 'Salesman'
FROM salesman
WHERE city='London'
UNION
(SELECT customer_id "ID", cust_name, 'Customer'
FROM customer
WHERE city='London')

```

#### Task6: write a SQL query to find the salespersons who generated the largest and smallest orders on each date. Return salesperson ID, name, order no., highest on/lowest on, order date.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Orders with columns Ord_no,purch_amt,ord_date,customer_id,salesman_id	
	
```
SELECT a.salesman_id, name, ord_no, 'highest on', ord_date
FROM salesman a, orders b
WHERE a.salesman_id =b.salesman_id
AND b.purch_amt=
	(SELECT MAX (purch_amt)
	FROM orders c
	WHERE c.ord_date = b.ord_date)
UNION
(SELECT a.salesman_id, name, ord_no, 'lowest on', ord_date
FROM salesman a, orders b
WHERE a.salesman_id =b.salesman_id
AND b.purch_amt=
	(SELECT MIN (purch_amt)
	FROM orders c
	WHERE c.ord_date = b.ord_date))

```

#### Task7: write a SQL query to find the salespeople who generated the largest and smallest orders on each date. Sort the result-set on third field. Return salesperson ID, name, order no., highest on/lowest on, order date.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Orders with columns Ord_no,purch_amt,ord_date,customer_id,salesman_id	

```
SELECT a.salesman_id, name, ord_no, 'highest on', ord_date
FROM salesman a, orders b
WHERE a.salesman_id =b.salesman_id
AND b.purch_amt=
	(SELECT MAX (purch_amt)
	FROM orders c
	WHERE c.ord_date = b.ord_date)
UNION
(SELECT a.salesman_id, name, ord_no, 'lowest on', ord_date
FROM salesman a, orders b
WHERE a.salesman_id =b.salesman_id
AND b.purch_amt=
	(SELECT MIN (purch_amt)
	FROM orders c
	WHERE c.ord_date = b.ord_date))
ORDER BY 3
```

#### Task8: Write a SQL statement to make a report with customer name, city, order number, order date, and order amount in ascending order according to the order date to determine whether any of the existing customers have placed an order or not.

	*table: Orders with columns Ord_no,purch_amt,ord_date,customer_id,salesman_id
	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id

```
SELECT a.cust_name,a.city, b.ord_no,
b.ord_date,b.purch_amt AS "Order Amount" 
FROM customer a 
LEFT OUTER JOIN orders b 
ON a.customer_id=b.customer_id 
order by b.ord_date;
```

#### Task9: write a SQL query to find those salespeople who live in the same city where the customer lives as well as those who do not have customers in their cities by indicating 'NO MATCH'. Sort the result set on 2nd column (i.e. name) in descending order. 
### Return salesperson ID, name, customer name, commission.

	*table: salesman with columns salesman_id,name,city,commission
	*table: Customer with columns customer_id,cust_name,city,grade,salesman_id
```
SELECT salesman.salesman_id, name, cust_name, commission
FROM salesman, customer
WHERE salesman.city = customer.city
UNION
(SELECT salesman_id, name, 'NO MATCH', commission
FROM salesman
WHERE NOT city = ANY
	(SELECT city
        FROM customer))
ORDER BY 2 DESC
```

### Task10:  write a SQL query to find the most expensive product of each company. Return pro_name, pro_price and com_name.

	*table: company_mast with columns COM_ID,COM_NAME
	*table: item_mast with columns PRO_ID,PRO_NAME,PRO_PRICE,PRO_COM
```	
SELECT A.pro_name, A.pro_price, F.com_name
   FROM item_mast A INNER JOIN company_mast F
   ON A.pro_com = F.com_id
     AND A.pro_price =
     (
       SELECT MAX(A.pro_price)
         FROM item_mast A
         WHERE A.pro_com = F.com_id
     );
```